<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>Enable Earth - ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit:400,700&display=swap">
  <style>
    :root {
      --primary: #04723d;
      --accent: #198754;
      --bg: #f9fbe8;
      --white: #fff;
      --shadow: 0 4px 18px 0 #0001;
    }
    body {
      margin: 0; background: var(--bg); font-family: 'Kanit', Arial, sans-serif; color: #1a2b2b;
    }
    header {
      background: var(--primary);
      color: #fff; display: flex; align-items: center; padding: 12px 0 8px 0;
      box-shadow: var(--shadow); justify-content: center; flex-direction: column;
    }
    .logo { height: 48px; margin-bottom: 4px; cursor:pointer; }
    .title {
      font-size: 1.5em; font-weight: bold; letter-spacing:0.5px;
    }
    .subtitle {
      font-size: 1em; opacity: .85; margin-bottom: 8px;
    }
    .form-container {
      background: var(--white);
      max-width: 420px; margin: 28px auto 0 auto; border-radius: 14px;
      box-shadow: var(--shadow); padding: 0 0 24px 0;
    }
    .step-header {
      background: var(--primary); color: #fff; border-radius: 14px 14px 0 0;
      padding: 18px 0; text-align: center; font-size: 1.3em; font-weight: bold;
      letter-spacing: .5px;
    }
    .progress-bar-bg {
      width: 90%; height: 8px; margin: 18px auto 10px auto;
      background: #eee; border-radius: 4px;
    }
    .progress-bar {
      height: 8px; border-radius: 4px;
      background: linear-gradient(90deg, var(--primary), #57e690);
      transition: width .3s;
    }
    .form-step { display: none; padding: 12px 28px 0 28px; }
    .form-step.active { display: block; }
    .input-group { margin-bottom: 18px;}
    label { font-weight: 500; display:block; margin-bottom: 6px; }
    input[type="text"], input[type="number"], input[type="tel"] {
      width: 100%; padding: 10px; border-radius: 6px;
      border: 1.5px solid #c7c7c7; font-size: 1em; margin-bottom: 2px;
      font-family: inherit; background: #f6f6fa;
    }
    textarea { width: 100%; border-radius: 6px; border: 1.5px solid #c7c7c7;
      padding: 10px; font-family: inherit; background: #f6f6fa;
    }
    .btn {
      font-family: inherit; font-size: 1.1em; border-radius: 8px;
      padding: 8px 28px; border: none; background: var(--accent); color: #fff;
      box-shadow: 0 1px 8px #0002; margin-top: 8px; cursor: pointer;
      transition: background .15s;
    }
    .btn:hover, .btn:active { background: #04723d; }
    .btn-outline {
      background: #fff; color: var(--primary); border: 2px solid var(--primary);
      margin-right: 12px;
    }
    .location-box, .camera-box {
      background: #f5fff4; border: 1.5px dashed #c9e5be;
      border-radius: 11px; padding: 18px 10px; margin-bottom: 18px; text-align: center;
    }
    .location-icon, .camera-icon {
      font-size: 2.5em; color: var(--accent); margin-bottom: 4px;
    }
    .mini-label { color: #666; font-size: 0.97em; margin-bottom: 3px;}
    .step-btn-row {
      display: flex; justify-content: space-between; margin-top: 20px;
    }
    .disabled { opacity: .6; pointer-events: none;}
    .contact-box {
      text-align: center; margin: 32px auto 0 auto; color: #075329;
      font-size: 1.04em;
    }
    .footer-logo { height: 34px; margin: 16px 0 8px 0; cursor:pointer;}
    .footer-contact {
      color: #247c43; margin: 0 0 3px 0; font-size: 1em;
    }
    .footer-links {
      margin-top: 5px; color: #247c43;
    }
    .footer-links a { color: #1658c2; text-decoration: none; margin: 0 7px; }
    .footer-links a:hover { text-decoration: underline; }
    @media (max-width:500px) {
      .form-container { max-width:98vw; padding:0 }
      .form-step { padding: 10px 7vw 0 7vw;}
    }
  </style>
</head>
<body>
<header>
  <img src="public/logo.jpg" class="logo" alt="Enable Logo" onclick="window.open('https://enableearth.eco/', '_blank')"/>
  <div class="title">Enable Earth</div>
  <div class="subtitle">‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ã‡∏±‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î</div>
</header>
<div class="progress-bar-bg">
  <div id="progress-bar" class="progress-bar" style="width:25%"></div>
</div>
<div class="form-container">
  <!-- Step 1 -->
  <div class="form-step active" id="step1">
    <div class="step-header">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>
    <div class="input-group">
      <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" id="fullname" required>
    </div>
    <div class="input-group">
      <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="tel" id="tel" pattern="[0-9]{9,10}" maxlength="10" required>
    </div>
    <div class="step-btn-row">
      <div></div>
      <button class="btn" onclick="gotoStep(2)">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>
  <!-- Step 2 -->
  <div class="form-step" id="step2">
    <div class="step-header">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏©‡∏ï‡∏£</div>
    <div class="input-group">
      <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà</label>
      <input type="number" min="0.1" step="0.1" id="farm_area" required>
    </div>
    <div class="input-group">
      <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
      <textarea id="farm_detail" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ã‡∏±‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö"></textarea>
    </div>
    <div class="step-btn-row">
      <button class="btn btn-outline" onclick="gotoStep(1)">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button class="btn" onclick="gotoStep(3)">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>
  <!-- Step 3 -->
  <div class="form-step" id="step3">
    <div class="step-header">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏≤</div>
    <div class="location-box" id="locationBox">
      <div class="location-icon">üìç</div>
      <div id="location-status">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
      <div id="location-coord"></div>
    </div>
    <button class="btn" onclick="detectLocation(event)">‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏≤</button>
    <div style="font-size:.92em; color:#757;">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ GPS ‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</div>
    <div class="step-btn-row">
      <button class="btn btn-outline" onclick="gotoStep(2)">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button class="btn" onclick="gotoStep(4)" id="btn-step3-next" disabled>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>
  <!-- Step 4 -->
  <div class="form-step" id="step4">
    <div class="step-header">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏û‡∏∑‡∏ä‡∏ú‡∏•</div>
    <div class="camera-box">
      <div class="camera-icon">üì∑</div>
      <div id="camera-status">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ã‡∏±‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡πÉ‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì<br>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ã‡∏±‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î</div>
      <input type="file" id="image" accept="image/*" capture="environment" style="margin-top:10px;">
    </div>
    <div class="step-btn-row">
      <button class="btn btn-outline" onclick="gotoStep(3)">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button class="btn" onclick="submitForm(event)">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>
  </div>
</div>
<div class="contact-box">
  <img src="public/logo.png" class="footer-logo" onclick="window.open('https://enableearth.eco/','_blank')"/><br>
  <span class="footer-contact">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤: <a href="mailto:contact@enableearth.eco">contact@enableearth.eco</a></span><br>
  <div class="footer-links">
    <a href="https://www.facebook.com/EnableEarthCarbonRemoval/" target="_blank">Facebook</a> | 
    <a href="https://m.me/EnableEarthCarbonRemoval/" target="_blank">Messenger</a>
  </div>
</div>
<script>
let currentStep = 1;
let userLocation = null;

function gotoStep(step) {
  event.preventDefault();
  if (step > 1 && !validateStep(currentStep)) return;
  for (let i = 1; i <= 4; i++) {
    document.getElementById('step'+i).classList.remove('active');
  }
  document.getElementById('step'+step).classList.add('active');
  currentStep = step;
  document.getElementById('progress-bar').style.width = (step*25)+'%';
}

// Location step (step 3)
function detectLocation(e){
  e.preventDefault();
  const locStatus = document.getElementById('location-status');
  locStatus.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á...";
  navigator.geolocation.getCurrentPosition(
    (pos) => {
      userLocation = pos.coords;
      locStatus.innerHTML = '<span style="color:green;font-weight:600;">‡πÑ‡∏î‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß!</span>';
      document.getElementById('location-coord').innerHTML =
        '‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î: '+userLocation.latitude+'<br>‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î: '+userLocation.longitude;
      document.getElementById('btn-step3-next').disabled = false;
    },
    (err) => {
      locStatus.innerHTML = '<span style="color:red;">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ ('+err.message+')</span>';
    }
  );
}

function validateStep(step) {
  if(step===1) {
    if(!document.getElementById('fullname').value.trim()) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'); return false;
    }
    if(!/^[0-9]{9,10}$/.test(document.getElementById('tel').value.trim())) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); return false;
    }
  }
  if(step===2) {
    if(!document.getElementById('farm_area').value.trim()) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà'); return false;
    }
  }
  if(step===3) {
    if(!userLocation) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏≤'); return false;
    }
  }
  return true;
}

function submitForm(e){
  e.preventDefault();
  if(!validateStep(4)) return;
  // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  const data = new FormData();
  data.append('fullname', document.getElementById('fullname').value);
  data.append('tel', document.getElementById('tel').value);
  data.append('farm_area', document.getElementById('farm_area').value);
  data.append('farm_detail', document.getElementById('farm_detail').value);
  data.append('latitude', userLocation ? userLocation.latitude : '');
  data.append('longitude', userLocation ? userLocation.longitude : '');
  const imgFile = document.getElementById('image').files[0];
  if(imgFile) data.append('image', imgFile);

  // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script (‡∏´‡∏£‡∏∑‡∏≠ API ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
  const apiURL = 'https://script.google.com/macros/s/AKfycbwjsnvnfVmURYof6Gb0xJrPxjbwSs6x7jjemDylWxw8J__SxnLale4BODtp0Vt8BNLgsQ/exec'; // ‡πÅ‡∏Å‡πâ URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  fetch(apiURL, { method:'POST', body:data })
    .then(r => r.text())
    .then(t => {
      alert('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£!');
      window.location.reload();
    }).catch(e=>{
      alert('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà: '+e.message);
    });
}
</script>
</body>
</html>
